<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Basic Usage - FedImpute</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../mkapi-common.css" rel="stylesheet" />
        <link href="../../css/mkdocstrings.css" rel="stylesheet" />
        <link href="../../css/custom.css" rel="stylesheet" />
        <link href="../../css/mkapi.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Basic Usage";
        var mkdocs_page_input_path = "tutorials\\basic_usage.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> FedImpute
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Quick Start</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../overview/">Overview of FedImpute</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../get_started/">Install & Basic Usage</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/data_prep/">Data Preparation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/scenario_simulation/">Distributed Missing Data Scenario Builder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/fed_imp/">Distributed Imputation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/evaluation/">Evaluation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/pipeline/">Pipeline API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorial</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Basic Usage</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../benchmark/">Benchmarking Pipeline Demo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../real_scenario/">Real World Distributed Imputation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../develop_new_method/">Developing Customized Methods</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/simulation/">Scenario Builder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/fed_impute/">Imputation Execution Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/imputation_models/">Imputation Models</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FedImpute</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Tutorial</li>
      <li class="breadcrumb-item active">Basic Usage</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tabulate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;arial&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">fonttype</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="n">fonttype</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
</code></pre></div>
<h1 id="load-data">Load Data</h1>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>

<span class="kn">from</span> <span class="nn">fedimpute.data_prep</span> <span class="kn">import</span> <span class="n">load_data</span><span class="p">,</span> <span class="n">display_data</span>
<span class="n">data</span><span class="p">,</span> <span class="n">data_config</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;codrna&quot;</span><span class="p">)</span>
<span class="n">display_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Dimensions: &quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Config:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data_config</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="nb">+--------+--------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="c">|   X1   |   X2   |   X3   |   X4   |   X5   |   X6   |   X7   |   X8   |   y    |</span>
<span class="c">|</span><span class="nb">--------+--------+--------+--------+--------+--------+--------+--------+--------</span><span class="c">|</span>
<span class="c">| 0</span><span class="nt">.</span><span class="c">7554 | 0</span><span class="nt">.</span><span class="c">1364 | 0</span><span class="nt">.</span><span class="c">0352 | 0</span><span class="nt">.</span><span class="c">4132 | 0</span><span class="nt">.</span><span class="c">6937 | 0</span><span class="nt">.</span><span class="c">1591 | 0</span><span class="nt">.</span><span class="c">3329 | 0</span><span class="nt">.</span><span class="c">7154 | 1</span><span class="nt">.</span><span class="c">0000 |</span>
<span class="c">| 0</span><span class="nt">.</span><span class="c">7334 | 0</span><span class="nt">.</span><span class="c">7879 | 0</span><span class="nt">.</span><span class="c">3819 | 0</span><span class="nt">.</span><span class="c">3693 | 0</span><span class="nt">.</span><span class="c">5619 | 0</span><span class="nt">.</span><span class="c">4830 | 0</span><span class="nt">.</span><span class="c">4351 | 0</span><span class="nt">.</span><span class="c">5160 | 0</span><span class="nt">.</span><span class="c">0000 |</span>
<span class="c">| 0</span><span class="nt">.</span><span class="c">7752 | 0</span><span class="nt">.</span><span class="c">1364 | 0</span><span class="nt">.</span><span class="c">1761 | 0</span><span class="nt">.</span><span class="c">3290 | 0</span><span class="nt">.</span><span class="c">7410 | 0</span><span class="nt">.</span><span class="c">4259 | 0</span><span class="nt">.</span><span class="c">4644 | 0</span><span class="nt">.</span><span class="c">5268 | 1</span><span class="nt">.</span><span class="c">0000 |</span>
<span class="c">| 0</span><span class="nt">.</span><span class="c">5905 | 0</span><span class="nt">.</span><span class="c">7424 | 0</span><span class="nt">.</span><span class="c">2720 | 0</span><span class="nt">.</span><span class="c">2898 | 0</span><span class="nt">.</span><span class="c">6920 | 0</span><span class="nt">.</span><span class="c">3205 | 0</span><span class="nt">.</span><span class="c">4019 | 0</span><span class="nt">.</span><span class="c">6290 | 1</span><span class="nt">.</span><span class="c">0000 |</span>
<span class="c">| 0</span><span class="nt">.</span><span class="c">7366 | 0</span><span class="nt">.</span><span class="c">1212 | 0</span><span class="nt">.</span><span class="c">2465 | 0</span><span class="nt">.</span><span class="c">3290 | 0</span><span class="nt">.</span><span class="c">7410 | 0</span><span class="nt">.</span><span class="c">3249 | 0</span><span class="nt">.</span><span class="c">5086 | 0</span><span class="nt">.</span><span class="c">5631 | 1</span><span class="nt">.</span><span class="c">0000 |</span>
<span class="nb">+--------+--------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="c">Data Dimensions:  (5000</span><span class="nt">,</span><span class="c"> 9)</span>
<span class="c">Data Config:</span>
<span class="c"> {&#39;target&#39;: &#39;y&#39;</span><span class="nt">,</span><span class="c"> &#39;task_type&#39;: &#39;classification&#39;</span><span class="nt">,</span><span class="c"> &#39;natural_partition&#39;: False}</span>
</code></pre></div>

<h1 id="scenario-simulation">Scenario Simulation</h1>
<h2 id="basic-usage">Basic Usage</h2>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="kn">from</span> <span class="nn">fedimpute.scenario</span> <span class="kn">import</span> <span class="n">ScenarioBuilder</span>

<span class="n">scenario_builder</span> <span class="o">=</span> <span class="n">ScenarioBuilder</span><span class="p">()</span>
<span class="n">scenario_data</span> <span class="o">=</span> <span class="n">scenario_builder</span><span class="o">.</span><span class="n">create_simulated_scenario</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">data_config</span><span class="p">,</span> <span class="n">num_clients</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">dp_strategy</span><span class="o">=</span><span class="s1">&#39;iid-even&#39;</span><span class="p">,</span> <span class="n">ms_scenario</span><span class="o">=</span><span class="s1">&#39;mnar-heter&#39;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Results Structure (Dict Keys):&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">scenario_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">scenario_builder</span><span class="o">.</span><span class="n">summarize_scenario</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">The</span><span class="w"> </span><span class="n">autoreload</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">loaded</span><span class="p">.</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="o">:</span>
<span class="w">  </span><span class="nf">%reload_ext</span><span class="w"> </span><span class="n">autoreload</span>
<span class="n">Missing</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">simulation</span><span class="p">...</span>
<span class="n">Results</span><span class="w"> </span><span class="n">Structure</span><span class="w"> </span><span class="p">(</span><span class="n">Dict</span><span class="w"> </span><span class="n">Keys</span><span class="p">)</span><span class="o">:</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">clients_train_data</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">clients_test_data</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">clients_train_data_ms</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">clients_seeds</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">global_test_data</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">data_config</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">stats</span><span class="err">&#39;</span><span class="p">]</span>
<span class="o">==================================================================</span>
<span class="n">Scenario</span><span class="w"> </span><span class="n">Summary</span>
<span class="o">==================================================================</span>
<span class="n">Total</span><span class="w"> </span><span class="n">clients</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span>
<span class="n">Global</span><span class="w"> </span><span class="n">Test</span><span class="w"> </span><span class="n">Data</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span>
<span class="n">Missing</span><span class="w"> </span><span class="n">Mechanism</span><span class="w"> </span><span class="n">Category</span><span class="o">:</span><span class="w"> </span><span class="n">MNAR</span><span class="w"> </span><span class="p">(</span><span class="n">Self</span><span class="w"> </span><span class="n">Masking</span><span class="w"> </span><span class="n">Logit</span><span class="p">)</span>
<span class="n">Clients</span><span class="w"> </span><span class="n">Data</span><span class="w"> </span><span class="n">Summary</span><span class="o">:</span>
<span class="w">     </span><span class="n">Train</span><span class="w">     </span><span class="n">Test</span><span class="w">      </span><span class="n">Miss</span><span class="w">     </span><span class="n">MS</span><span class="w"> </span><span class="n">Ratio</span><span class="w">    </span><span class="n">MS</span><span class="w"> </span><span class="n">Feature</span><span class="w">    </span><span class="n">Seed</span>
<span class="o">--</span><span class="w">  </span><span class="o">--------</span><span class="w">  </span><span class="o">-------</span><span class="w">  </span><span class="o">--------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">------------</span><span class="w">  </span><span class="o">------</span>
<span class="n">C1</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">113</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">     </span><span class="mf">0.47</span><span class="w">         </span><span class="mi">8</span><span class="o">/</span><span class="mi">8</span><span class="w">        </span><span class="mi">6077</span>
<span class="n">C2</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">113</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">     </span><span class="mf">0.51</span><span class="w">         </span><span class="mi">8</span><span class="o">/</span><span class="mi">8</span><span class="w">        </span><span class="mi">577</span>
<span class="n">C3</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">113</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">     </span><span class="mf">0.46</span><span class="w">         </span><span class="mi">8</span><span class="o">/</span><span class="mi">8</span><span class="w">        </span><span class="mi">7231</span>
<span class="n">C4</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">113</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w">  </span><span class="p">(</span><span class="mi">1125</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">     </span><span class="mf">0.47</span><span class="w">         </span><span class="mi">8</span><span class="o">/</span><span class="mi">8</span><span class="w">        </span><span class="mi">5504</span>
<span class="o">==================================================================</span>
</code></pre></div>

<h2 id="exploring-scenario">Exploring Scenario</h2>
<h3 id="data-heterogeneity">Data Heterogeneity</h3>
<div class="highlight"><pre><span></span><code><span class="n">scenario_builder</span><span class="o">.</span><span class="n">visualize_data_heterogeneity</span><span class="p">(</span>
    <span class="n">client_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> 
    <span class="n">distance_method</span><span class="o">=</span><span class="s1">&#39;swd&#39;</span><span class="p">,</span>
    <span class="n">pca_col_threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;./plots/data_heterogeneity.svg&#39;</span>
<span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../basic_usage_files/output_9_0.png" /></p>
<h3 id="missing-data-inspection">Missing Data Inspection</h3>
<div class="highlight"><pre><span></span><code><span class="n">scenario_builder</span><span class="o">.</span><span class="n">visualize_missing_pattern</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;./plots/ms_pattern.pdf&#39;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../basic_usage_files/output_11_0.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">scenario_builder</span><span class="o">.</span><span class="n">visualize_missing_distribution</span><span class="p">(</span>
    <span class="n">client_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">feature_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;proportion&#39;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;./plots/ms_distribution.pdf&#39;</span>
<span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../basic_usage_files/output_12_0.png" /></p>
<h1 id="running-federated-imputation">Running Federated Imputation</h1>
<h2 id="basic-usage_1">Basic Usage</h2>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="kn">from</span> <span class="nn">fedimpute.execution_environment</span> <span class="kn">import</span> <span class="n">FedImputeEnv</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">FedImputeEnv</span><span class="p">(</span><span class="n">debug_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">configuration</span><span class="p">(</span><span class="n">imputer</span> <span class="o">=</span> <span class="s1">&#39;mice&#39;</span><span class="p">,</span> <span class="n">fed_strategy</span><span class="o">=</span><span class="s1">&#39;fedmice&#39;</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">setup_from_scenario_builder</span><span class="p">(</span><span class="n">scenario_builder</span> <span class="o">=</span> <span class="n">scenario_builder</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">show_env_info</span><span class="p">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">run_fed_imputation</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">The</span><span class="w"> </span><span class="n">autoreload</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">loaded</span><span class="p">.</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="o">:</span>
<span class="w">  </span><span class="nf">%reload_ext</span><span class="w"> </span><span class="n">autoreload</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mSetting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">clients</span><span class="p">...</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mSetting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">server</span><span class="p">...</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mSetting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">workflow</span><span class="p">...</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mEnvironment</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="o">============================================================</span>
<span class="n">Environment</span><span class="w"> </span><span class="n">Information</span><span class="o">:</span>
<span class="o">============================================================</span>
<span class="nl">Workflow</span><span class="p">:</span><span class="w"> </span><span class="n">ICE</span><span class="w"> </span><span class="p">(</span><span class="n">Imputation</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">Chain</span><span class="w"> </span><span class="n">Equation</span><span class="p">)</span>
<span class="nl">Clients</span><span class="p">:</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">imputer</span><span class="o">:</span><span class="w"> </span><span class="n">mice</span><span class="p">,</span><span class="w"> </span><span class="n">fed</span><span class="o">-</span><span class="n">strategy</span><span class="o">:</span><span class="w"> </span><span class="n">fedmice</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">imputer</span><span class="o">:</span><span class="w"> </span><span class="n">mice</span><span class="p">,</span><span class="w"> </span><span class="n">fed</span><span class="o">-</span><span class="n">strategy</span><span class="o">:</span><span class="w"> </span><span class="n">fedmice</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">imputer</span><span class="o">:</span><span class="w"> </span><span class="n">mice</span><span class="p">,</span><span class="w"> </span><span class="n">fed</span><span class="o">-</span><span class="n">strategy</span><span class="o">:</span><span class="w"> </span><span class="n">fedmice</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">imputer</span><span class="o">:</span><span class="w"> </span><span class="n">mice</span><span class="p">,</span><span class="w"> </span><span class="n">fed</span><span class="o">-</span><span class="n">strategy</span><span class="o">:</span><span class="w"> </span><span class="n">fedmice</span>
<span class="nl">Server</span><span class="p">:</span><span class="w"> </span><span class="n">fed</span><span class="o">-</span><span class="n">strategy</span><span class="o">:</span><span class="w"> </span><span class="n">fedmice</span>
<span class="o">============================================================</span>

<span class="err"></span><span class="p">[</span><span class="mi">32</span><span class="n">m</span><span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mImputation</span><span class="w"> </span><span class="n">Start</span><span class="w"> </span><span class="p">...</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mInitial</span><span class="o">:</span><span class="w"> </span><span class="n">imp_rmse</span><span class="o">:</span><span class="w"> </span><span class="mf">0.1664</span><span class="w"> </span><span class="n">imp_ws</span><span class="o">:</span><span class="w"> </span><span class="mf">0.0831</span><span class="w"> </span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mEpoch</span><span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">loss</span><span class="o">:</span><span class="w"> </span><span class="mf">0.0026</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mAll</span><span class="w"> </span><span class="n">clients</span><span class="w"> </span><span class="n">converged</span><span class="p">,</span><span class="w"> </span><span class="n">iteration</span><span class="w"> </span><span class="mi">8</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mFinal</span><span class="o">:</span><span class="w"> </span><span class="n">imp_rmse</span><span class="o">:</span><span class="w"> </span><span class="mf">0.1530</span><span class="w"> </span><span class="n">imp_ws</span><span class="o">:</span><span class="w"> </span><span class="mf">0.0687</span><span class="w"> </span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">32</span><span class="n">m</span><span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="n">mFinished</span><span class="p">.</span><span class="w"> </span><span class="n">Running</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mf">10.4787</span><span class="w"> </span><span class="n">seconds</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="n">m</span>
</code></pre></div>

<h2 id="monitoring-imputation-progress">Monitoring Imputation Progress</h2>
<div class="highlight"><pre><span></span><code><span class="n">env</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">visualize_imputation_process</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="../basic_usage_files/output_17_0.png" /></p>
<h1 id="evaluation">Evaluation</h1>
<h3 id="imputation-quality">Imputation Quality</h3>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="kn">from</span> <span class="nn">fedimpute.evaluation</span> <span class="kn">import</span> <span class="n">Evaluator</span>

<span class="n">X_trains</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train_imp&#39;</span><span class="p">)</span>
<span class="n">X_train_masks</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train_mask&#39;</span><span class="p">)</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate_imp_quality</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">X_train_origins</span> <span class="o">=</span> <span class="n">X_trains</span><span class="p">,</span>
    <span class="n">X_train_masks</span> <span class="o">=</span> <span class="n">X_train_masks</span><span class="p">,</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;nrmse&#39;</span><span class="p">,</span> <span class="s1">&#39;sliced-ws&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">show_imp_results</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">The</span><span class="w"> </span><span class="n">autoreload</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">loaded</span><span class="p">.</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="o">:</span>
<span class="w">  </span><span class="nf">%reload_ext</span><span class="w"> </span><span class="n">autoreload</span>
<span class="o">================================================</span>
<span class="n">Imputation</span><span class="w"> </span><span class="n">Quality</span>
<span class="o">================================================</span>
<span class="w">               </span><span class="n">rmse</span><span class="w">       </span><span class="n">nrmse</span><span class="w">      </span><span class="n">sliced</span><span class="o">-</span><span class="n">ws</span>
<span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">-----------</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="mf">0.181</span><span class="w">       </span><span class="mf">0.505</span><span class="w">        </span><span class="mf">0.080</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">2</span><span class="w">     </span><span class="mf">0.187</span><span class="w">       </span><span class="mf">0.543</span><span class="w">        </span><span class="mf">0.094</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">3</span><span class="w">     </span><span class="mf">0.117</span><span class="w">       </span><span class="mf">0.325</span><span class="w">        </span><span class="mf">0.045</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">4</span><span class="w">     </span><span class="mf">0.126</span><span class="w">       </span><span class="mf">0.354</span><span class="w">        </span><span class="mf">0.056</span>
<span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span>
<span class="w"> </span><span class="n">Average</span><span class="w">      </span><span class="mf">0.153</span><span class="w">       </span><span class="mf">0.432</span><span class="w">        </span><span class="mf">0.069</span>
<span class="w">   </span><span class="n">Std</span><span class="w">        </span><span class="mf">0.032</span><span class="w">       </span><span class="mf">0.094</span><span class="w">        </span><span class="mf">0.019</span>
<span class="o">================================================</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">X_trains</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train_imp&#39;</span><span class="p">)</span>

<span class="n">evaluator</span><span class="o">.</span><span class="n">tsne_visualization</span><span class="p">(</span>
    <span class="n">X_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">X_origins</span> <span class="o">=</span> <span class="n">X_trains</span><span class="p">,</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="nv">Evaluating</span><span class="w"> </span><span class="nv">TSNE</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Client</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>...
<span class="nv">Evaluating</span><span class="w"> </span><span class="nv">TSNE</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Client</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span>...
<span class="nv">Evaluating</span><span class="w"> </span><span class="nv">TSNE</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Client</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span>...
<span class="nv">Evaluating</span><span class="w"> </span><span class="nv">TSNE</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Client</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span>...
</code></pre></div>

<p><img alt="png" src="output_21_1.png" /></p>
<h3 id="local-prediction">Local Prediction</h3>
<div class="highlight"><pre><span></span><code><span class="n">X_train_imps</span><span class="p">,</span> <span class="n">y_trains</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train_imp&#39;</span><span class="p">,</span> <span class="n">include_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_tests</span><span class="p">,</span> <span class="n">y_tests</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">include_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_global_test</span><span class="p">,</span> <span class="n">y_global_test</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;global_test&#39;</span><span class="p">,</span> <span class="n">include_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;config&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">run_local_prediction</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">y_trains</span> <span class="o">=</span> <span class="n">y_trains</span><span class="p">,</span>
    <span class="n">X_tests</span> <span class="o">=</span> <span class="n">X_tests</span><span class="p">,</span>
    <span class="n">y_tests</span> <span class="o">=</span> <span class="n">y_tests</span><span class="p">,</span>
    <span class="n">data_config</span> <span class="o">=</span> <span class="n">data_config</span><span class="p">,</span>
    <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;rf&#39;</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">show_local_prediction_results</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">Clients</span><span class="o">:</span><span class="w">   </span><span class="mi">0</span><span class="o">%|</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="sr">/4 [00:00&lt;?, ?it/s</span><span class="o">]</span>


<span class="o">==========================================================</span>
<span class="n">Downstream</span><span class="w"> </span><span class="n">Prediction</span><span class="w"> </span><span class="o">(</span><span class="n">Local</span><span class="o">)</span>
<span class="o">==========================================================</span>
<span class="w">             </span><span class="n">accuracy</span><span class="w">       </span><span class="n">f1</span><span class="w">         </span><span class="n">auc</span><span class="w">         </span><span class="n">prc</span>
<span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="mf">0.894</span><span class="w">       </span><span class="mf">0.842</span><span class="w">       </span><span class="mf">0.975</span><span class="w">       </span><span class="mf">0.946</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">2</span><span class="w">     </span><span class="mf">0.965</span><span class="w">       </span><span class="mf">0.946</span><span class="w">       </span><span class="mf">0.996</span><span class="w">       </span><span class="mf">0.992</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">3</span><span class="w">     </span><span class="mf">0.956</span><span class="w">       </span><span class="mf">0.932</span><span class="w">       </span><span class="mf">0.982</span><span class="w">       </span><span class="mf">0.975</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">4</span><span class="w">     </span><span class="mf">0.920</span><span class="w">       </span><span class="mf">0.873</span><span class="w">       </span><span class="mf">0.961</span><span class="w">       </span><span class="mf">0.924</span>
<span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span>
<span class="w"> </span><span class="n">Average</span><span class="w">      </span><span class="mf">0.934</span><span class="w">       </span><span class="mf">0.898</span><span class="w">       </span><span class="mf">0.979</span><span class="w">       </span><span class="mf">0.959</span>
<span class="w">   </span><span class="n">Std</span><span class="w">        </span><span class="mf">0.028</span><span class="w">       </span><span class="mf">0.042</span><span class="w">       </span><span class="mf">0.013</span><span class="w">       </span><span class="mf">0.026</span>
<span class="o">==========================================================</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">run_local_prediction</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">y_trains</span> <span class="o">=</span> <span class="n">y_trains</span><span class="p">,</span>
    <span class="n">X_tests</span> <span class="o">=</span> <span class="n">X_tests</span><span class="p">,</span>
    <span class="n">y_tests</span> <span class="o">=</span> <span class="n">y_tests</span><span class="p">,</span>
    <span class="n">data_config</span> <span class="o">=</span> <span class="n">data_config</span><span class="p">,</span>
    <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;lr&#39;</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">show_local_prediction_results</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">Clients</span><span class="o">:</span><span class="w">   </span><span class="mi">0</span><span class="o">%|</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="sr">/4 [00:00&lt;?, ?it/s</span><span class="o">]</span>


<span class="o">==========================================================</span>
<span class="n">Downstream</span><span class="w"> </span><span class="n">Prediction</span><span class="w"> </span><span class="o">(</span><span class="n">Local</span><span class="o">)</span>
<span class="o">==========================================================</span>
<span class="w">             </span><span class="n">accuracy</span><span class="w">       </span><span class="n">f1</span><span class="w">         </span><span class="n">auc</span><span class="w">         </span><span class="n">prc</span>
<span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">1</span><span class="w">     </span><span class="mf">0.903</span><span class="w">       </span><span class="mf">0.871</span><span class="w">       </span><span class="mf">0.990</span><span class="w">       </span><span class="mf">0.977</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">2</span><span class="w">     </span><span class="mf">0.903</span><span class="w">       </span><span class="mf">0.845</span><span class="w">       </span><span class="mf">0.962</span><span class="w">       </span><span class="mf">0.935</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">3</span><span class="w">     </span><span class="mf">0.850</span><span class="w">       </span><span class="mf">0.809</span><span class="w">       </span><span class="mf">0.950</span><span class="w">       </span><span class="mf">0.911</span>
<span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="mi">4</span><span class="w">     </span><span class="mf">0.823</span><span class="w">       </span><span class="mf">0.778</span><span class="w">       </span><span class="mf">0.973</span><span class="w">       </span><span class="mf">0.968</span>
<span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span><span class="w">  </span><span class="o">----------</span>
<span class="w"> </span><span class="n">Average</span><span class="w">      </span><span class="mf">0.869</span><span class="w">       </span><span class="mf">0.826</span><span class="w">       </span><span class="mf">0.968</span><span class="w">       </span><span class="mf">0.948</span>
<span class="w">   </span><span class="n">Std</span><span class="w">        </span><span class="mf">0.034</span><span class="w">       </span><span class="mf">0.035</span><span class="w">       </span><span class="mf">0.015</span><span class="w">       </span><span class="mf">0.027</span>
<span class="o">==========================================================</span>
</code></pre></div>

<h3 id="federated-prediction">Federated Prediction</h3>
<div class="highlight"><pre><span></span><code><span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">run_fed_prediction</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">y_trains</span> <span class="o">=</span> <span class="n">y_trains</span><span class="p">,</span>
    <span class="n">X_tests</span> <span class="o">=</span> <span class="n">X_tests</span><span class="p">,</span>
    <span class="n">y_tests</span> <span class="o">=</span> <span class="n">y_tests</span><span class="p">,</span>
    <span class="n">X_test_global</span> <span class="o">=</span> <span class="n">X_global_test</span><span class="p">,</span>
    <span class="n">y_test_global</span> <span class="o">=</span> <span class="n">y_global_test</span><span class="p">,</span>
    <span class="n">data_config</span> <span class="o">=</span> <span class="n">data_config</span><span class="p">,</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;rf&#39;</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="n">evaluator</span><span class="o">.</span><span class="n">show_fed_prediction_results</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>===============================================================
Downstream Prediction (Fed)
===============================================================
 Personalized    accuracy       f1         auc         prc
--------------  ----------  ----------  ----------  ----------
   Client 1       0.956       0.932       0.988       0.962
   Client 2       0.956       0.930       0.995       0.989
   Client 3       0.956       0.932       0.995       0.989
   Client 4       0.876       0.800       0.969       0.943
  ----------    ----------  ----------  ----------  ----------
    Global        0.914       0.862       0.952       0.906
===============================================================
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">run_fed_prediction</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">y_trains</span> <span class="o">=</span> <span class="n">y_trains</span><span class="p">,</span>
    <span class="n">X_tests</span> <span class="o">=</span> <span class="n">X_tests</span><span class="p">,</span>
    <span class="n">y_tests</span> <span class="o">=</span> <span class="n">y_tests</span><span class="p">,</span>
    <span class="n">X_test_global</span> <span class="o">=</span> <span class="n">X_global_test</span><span class="p">,</span>
    <span class="n">y_test_global</span> <span class="o">=</span> <span class="n">y_global_test</span><span class="p">,</span>
    <span class="n">data_config</span> <span class="o">=</span> <span class="n">data_config</span><span class="p">,</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;lr&#39;</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="n">evaluator</span><span class="o">.</span><span class="n">show_fed_prediction_results</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>(900, 8) (900,)


                                                                3.52it/s]

===============================================================
Downstream Prediction (Fed)
===============================================================
 Personalized    accuracy       f1         auc         prc
--------------  ----------  ----------  ----------  ----------
   Client 1       0.912       0.878       0.982       0.955
   Client 2       0.920       0.892       0.996       0.992
   Client 3       0.903       0.867       0.968       0.947
   Client 4       0.876       0.833       0.972       0.960
  ----------    ----------  ----------  ----------  ----------
    Global        0.912       0.878       0.979       0.953
===============================================================
</code></pre></div>

<h3 id="all-in-one">All In One</h3>
<div class="highlight"><pre><span></span><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="kn">from</span> <span class="nn">fedimpute.evaluation</span> <span class="kn">import</span> <span class="n">Evaluator</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate_all</span><span class="p">(</span>
    <span class="n">env</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;imp_quality&#39;</span><span class="p">,</span> <span class="s1">&#39;pred_downstream_local&#39;</span><span class="p">,</span> <span class="s1">&#39;pred_downstream_fed&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">show_results_all</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err"></span><span class="p">[</span><span class="mf">1</span><span class="nx">mEvaluating</span><span class="w"> </span><span class="nx">imputation</span><span class="w"> </span><span class="nx">quality</span><span class="p">...</span><span class="err"></span><span class="p">[</span><span class="mf">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mf">1</span><span class="nx">mImputation</span><span class="w"> </span><span class="nx">quality</span><span class="w"> </span><span class="nx">evaluation</span><span class="w"> </span><span class="nx">completed</span><span class="p">.</span><span class="err"></span><span class="p">[</span><span class="mf">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mf">1</span><span class="nx">mEvaluating</span><span class="w"> </span><span class="nx">downstream</span><span class="w"> </span><span class="nx">prediction</span><span class="p">...</span><span class="err"></span><span class="p">[</span><span class="mf">0</span><span class="nx">m</span>



<span class="nx">Clients</span><span class="o">:</span><span class="w">   </span><span class="mf">0</span><span class="o">%|</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mf">0</span><span class="o">/</span><span class="mf">4</span><span class="w"> </span><span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="cp">&lt;?</span><span class="p">,</span> <span class="o">?</span><span class="nx">it</span><span class="o">/</span><span class="nx">s</span><span class="p">]</span>


<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">593</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">287</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">583</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">360</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mDownstream</span> <span class="nx">prediction</span> <span class="nx">evaluation</span> <span class="nx">completed</span><span class="o">.</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEvaluating</span> <span class="nx">federated</span> <span class="nx">downstream</span> <span class="nx">prediction</span><span class="o">...</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>



<span class="k">Global</span> <span class="nx">Epoch</span><span class="o">:</span>   <span class="mi">0</span><span class="o">%|</span>          <span class="o">|</span> <span class="mi">0</span><span class="o">/</span><span class="mi">100</span> <span class="p">[</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">&lt;?</span><span class="p">,</span> <span class="o">?</span><span class="nx">it</span><span class="o">/</span><span class="nx">s</span><span class="p">]</span>


<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">0</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.6716053117724026</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">10</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.5709273157750859</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">20</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.48411076998009406</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">30</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.4436344894416192</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">40</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.43356676005265293</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">50</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.4266376635607551</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">60</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.4221082873204175</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">65</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">70</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.40617619396424764</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">71</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">74</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEpoch</span> <span class="mi">80</span> <span class="o">-</span> <span class="nx">average</span> <span class="nx">loss</span><span class="o">:</span> <span class="mf">0.3788260501973769</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">81</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">100</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">121</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEarly</span> <span class="nx">stopping</span> <span class="nx">at</span> <span class="nx">epoch</span> <span class="mi">125</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mFederated</span> <span class="nx">downstream</span> <span class="nx">prediction</span> <span class="nx">evaluation</span> <span class="nx">completed</span><span class="o">.</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
<span class="err"></span><span class="p">[</span><span class="mi">1</span><span class="nx">mEvaluation</span> <span class="nx">completed</span><span class="o">.</span><span class="err"></span><span class="p">[</span><span class="mi">0</span><span class="nx">m</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">imp_quality</th>
      <th colspan="4" halign="left">pred_downstream_local</th>
      <th colspan="8" halign="left">pred_downstream_fed</th>
    </tr>
    <tr>
      <th></th>
      <th>rmse</th>
      <th>nrmse</th>
      <th>sliced-ws</th>
      <th>accuracy</th>
      <th>f1</th>
      <th>auc</th>
      <th>prc</th>
      <th>personalized_accuracy</th>
      <th>personalized_f1</th>
      <th>personalized_auc</th>
      <th>personalized_prc</th>
      <th>global_accuracy</th>
      <th>global_f1</th>
      <th>global_auc</th>
      <th>global_prc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.172028</td>
      <td>0.479522</td>
      <td>0.075509</td>
      <td>0.787611</td>
      <td>0.636364</td>
      <td>0.860953</td>
      <td>0.741470</td>
      <td>0.884956</td>
      <td>0.831169</td>
      <td>0.958037</td>
      <td>0.900117</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.184269</td>
      <td>0.533933</td>
      <td>0.090226</td>
      <td>0.893805</td>
      <td>0.823529</td>
      <td>0.952703</td>
      <td>0.934722</td>
      <td>0.920354</td>
      <td>0.883117</td>
      <td>0.981508</td>
      <td>0.956229</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.119754</td>
      <td>0.331969</td>
      <td>0.047390</td>
      <td>0.929204</td>
      <td>0.894737</td>
      <td>0.975818</td>
      <td>0.969489</td>
      <td>0.884956</td>
      <td>0.835443</td>
      <td>0.975462</td>
      <td>0.951035</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.128211</td>
      <td>0.359113</td>
      <td>0.057849</td>
      <td>0.752212</td>
      <td>0.481481</td>
      <td>0.854196</td>
      <td>0.760059</td>
      <td>0.867257</td>
      <td>0.819277</td>
      <td>0.972617</td>
      <td>0.961279</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="export-evaluation-results-in-different-format">Export Evaluation Results in Different Format</h3>
<div class="highlight"><pre><span></span><code><span class="n">evaluator</span><span class="o">.</span><span class="n">export_results</span><span class="p">(</span><span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;dataframe&#39;</span><span class="p">)</span>
</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">imp_quality</th>
      <th colspan="4" halign="left">pred_downstream_local</th>
      <th colspan="8" halign="left">pred_downstream_fed</th>
    </tr>
    <tr>
      <th></th>
      <th>rmse</th>
      <th>nrmse</th>
      <th>sliced-ws</th>
      <th>accuracy</th>
      <th>f1</th>
      <th>auc</th>
      <th>prc</th>
      <th>personalized_accuracy</th>
      <th>personalized_f1</th>
      <th>personalized_auc</th>
      <th>personalized_prc</th>
      <th>global_accuracy</th>
      <th>global_f1</th>
      <th>global_auc</th>
      <th>global_prc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.172028</td>
      <td>0.479522</td>
      <td>0.075509</td>
      <td>0.787611</td>
      <td>0.636364</td>
      <td>0.860953</td>
      <td>0.741470</td>
      <td>0.884956</td>
      <td>0.831169</td>
      <td>0.958037</td>
      <td>0.900117</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.184269</td>
      <td>0.533933</td>
      <td>0.090226</td>
      <td>0.893805</td>
      <td>0.823529</td>
      <td>0.952703</td>
      <td>0.934722</td>
      <td>0.920354</td>
      <td>0.883117</td>
      <td>0.981508</td>
      <td>0.956229</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.119754</td>
      <td>0.331969</td>
      <td>0.047390</td>
      <td>0.929204</td>
      <td>0.894737</td>
      <td>0.975818</td>
      <td>0.969489</td>
      <td>0.884956</td>
      <td>0.835443</td>
      <td>0.975462</td>
      <td>0.951035</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.128211</td>
      <td>0.359113</td>
      <td>0.057849</td>
      <td>0.752212</td>
      <td>0.481481</td>
      <td>0.854196</td>
      <td>0.760059</td>
      <td>0.867257</td>
      <td>0.819277</td>
      <td>0.972617</td>
      <td>0.961279</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><code><span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">export_results</span><span class="p">(</span><span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;dict-dataframe&#39;</span><span class="p">)</span>
<span class="n">ret</span><span class="p">[</span><span class="s1">&#39;imp_quality&#39;</span><span class="p">]</span>
</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rmse</th>
      <th>nrmse</th>
      <th>sliced-ws</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.172028</td>
      <td>0.479522</td>
      <td>0.075509</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.184269</td>
      <td>0.533933</td>
      <td>0.090226</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.119754</td>
      <td>0.331969</td>
      <td>0.047390</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.128211</td>
      <td>0.359113</td>
      <td>0.057849</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><code><span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">export_results</span><span class="p">(</span><span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;dict-dataframe&#39;</span><span class="p">)</span>
<span class="n">ret</span><span class="p">[</span><span class="s1">&#39;pred_downstream_fed&#39;</span><span class="p">]</span>
</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>personalized_accuracy</th>
      <th>personalized_f1</th>
      <th>personalized_auc</th>
      <th>personalized_prc</th>
      <th>global_accuracy</th>
      <th>global_f1</th>
      <th>global_auc</th>
      <th>global_prc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.884956</td>
      <td>0.831169</td>
      <td>0.958037</td>
      <td>0.900117</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.920354</td>
      <td>0.883117</td>
      <td>0.981508</td>
      <td>0.956229</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.884956</td>
      <td>0.835443</td>
      <td>0.975462</td>
      <td>0.951035</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.867257</td>
      <td>0.819277</td>
      <td>0.972617</td>
      <td>0.961279</td>
      <td>0.906</td>
      <td>0.86217</td>
      <td>0.968807</td>
      <td>0.94098</td>
    </tr>
  </tbody>
</table>
</div>

<h1 id="regression-analysis">regression analysis</h1>
<div class="highlight"><pre><span></span><code><span class="n">X_trains</span><span class="p">,</span> <span class="n">y_trains</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">include_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;config&#39;</span><span class="p">)</span>
<span class="n">data_config</span><span class="p">[</span><span class="s1">&#39;task_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;classification&#39;</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">run_local_regression_analysis</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">y_trains</span> <span class="o">=</span> <span class="n">y_trains</span><span class="p">,</span>
    <span class="n">data_config</span> <span class="o">=</span> <span class="n">data_config</span>
<span class="p">)</span>

<span class="n">evaluator</span><span class="o">.</span><span class="n">show_local_regression_results</span><span class="p">(</span><span class="n">client_idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>                  Local Logit Regression Results (client 1)                   
==============================================================================
Dep. Variable:                      y   No. Observations:                 1125
Model:                          Logit   Df Residuals:                     1116
Method:                           MLE   Df Model:                            8
Date:                Mon, 21 Apr 2025   Pseudo R-squ.:                  0.2545
Time:                        16:28:07   Log-Likelihood:                -528.54
converged:                       True   LL-Null:                       -708.95
<span class="gh">Covariance Type:            nonrobust   LLR p-value:                 4.432e-73</span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const         47.6797      4.807      9.919      0.000      38.258      57.101
X1           -82.3736      7.642    -10.779      0.000     -97.351     -67.396
X2           -19.5991      2.591     -7.563      0.000     -24.678     -14.520
X3            10.0812      3.236      3.116      0.002       3.739      16.423
X4             8.6467      4.951      1.747      0.081      -1.056      18.350
X5             4.8074      6.234      0.771      0.441      -7.411      17.026
X6            15.6919      4.340      3.616      0.000       7.187      24.197
X7            11.8661      4.610      2.574      0.010       2.831      20.901
<span class="gh">X8             5.4795      6.139      0.893      0.372      -6.553      17.512</span>
<span class="gh">==============================================================================</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">X_trains</span><span class="p">,</span> <span class="n">y_trains</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">client_ids</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">include_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;config&#39;</span><span class="p">)</span>
<span class="n">data_config</span><span class="p">[</span><span class="s1">&#39;task_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;classification&#39;</span>

<span class="n">evaluator</span><span class="o">.</span><span class="n">run_fed_regression_analysis</span><span class="p">(</span>
    <span class="n">X_train_imps</span> <span class="o">=</span> <span class="n">X_train_imps</span><span class="p">,</span>
    <span class="n">y_trains</span> <span class="o">=</span> <span class="n">y_trains</span><span class="p">,</span>
    <span class="n">data_config</span> <span class="o">=</span> <span class="n">data_config</span>
<span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">show_fed_regression_results</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>                      Federated Logit Regression Result                       
==============================================================================
Dep. Variable:                      y   No. Observations:                 4500
Model:                          Logit   Df Residuals:                     4491
Method:                           MLE   Df Model:                            8
Date:                Mon, 21 Apr 2025   Pseudo R-squ.:                  0.2478
Time:                        16:28:24   Log-Likelihood:                -2133.1
converged:                       True   LL-Null:                       -2835.8
<span class="gh">Covariance Type:            nonrobust   LLR p-value:                4.035e-298</span>
<span class="gh">==============================================================================</span>
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const         30.4160      0.129    235.463      0.000      30.163      30.669
X1           -63.3583      0.231   -274.762      0.000     -63.810     -62.906
X2           -16.1744      0.064   -254.610      0.000     -16.299     -16.050
X3            15.2472      0.078    194.635      0.000      15.094      15.401
X4            11.3237      0.084    134.553      0.000      11.159      11.489
X5            10.7434      0.103    103.972      0.000      10.541      10.946
X6            10.6433      0.083    128.952      0.000      10.482      10.805
X7             8.6910      0.090     96.851      0.000       8.515       8.867
<span class="gh">X8             1.0197      0.114      8.956      0.000       0.797       1.243</span>
<span class="gh">==============================================================================</span>
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../user-guide/pipeline/" class="btn btn-neutral float-left" title="Pipeline API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../benchmark/" class="btn btn-neutral float-right" title="Benchmarking Pipeline Demo">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../user-guide/pipeline/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../benchmark/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
