<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Data Preparation - FedImpute</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../mkapi-common.css" rel="stylesheet" />
        <link href="../../css/mkdocstrings.css" rel="stylesheet" />
        <link href="../../css/custom.css" rel="stylesheet" />
        <link href="../../css/mkapi.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Data Preparation";
        var mkdocs_page_input_path = "user-guide\\data_prep.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> FedImpute
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Quick Start</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../overview/">Overview of FedImpute</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../get_started/">Install & Basic Usage</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Data Preparation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#input-data-format-and-preprocessing">Input Data Format and Preprocessing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-preprocessing-steps">Required Preprocessing Steps</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#ordering-features">Ordering Features</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#one-hot-encoding-categorical-features">One-hot Encoding Categorical Features</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#data-normalization-optional">Data Normalization (Optional)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#helper-functions-for-preprocessing">Helper Functions for Preprocessing</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-configuration-dictionary">Data Configuration Dictionary</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenario_simulation/">Federated Missing Data Scenario Simulation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fed_imp/">Federated Imputation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../evaluation/">Evaluation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/simulation/">Scenario simulation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/fed_impute/">FedImpute Execution Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/imputation_models/">Imputation Models</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FedImpute</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">User Guide</li>
      <li class="breadcrumb-item active">Data Preparation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="dataset-and-preprocessing">Dataset and Preprocessing</h1>
<p>The first step for using FedImpute is to prepare the data. </p>
<h2 id="input-data-format-and-preprocessing">Input Data Format and Preprocessing</h2>
<p>The data should be tabular data in the form of a <strong>numpy array</strong> (<code>&lt;np.ndarray&gt;</code>) or <strong>List of numpy arrays</strong> for those <strong><em>naturally partitioned federated data</em></strong>, where each row represents an observation and each column represents a feature. 
It will be the input to the simulation process, where it will be partitioned into subset as local dataset for each party and the missing data will be introduced.</p>
<h3 id="required-preprocessing-steps">Required Preprocessing Steps</h3>
<p>There are some basic <strong>preprocessing steps</strong> that you need to follow before using FedImpute, 
The final dataset should be in the form of a numpy array with the columns ordered as follows format: </p>
<div class="highlight"><pre><span></span><code>| --------------------- | ------------------ | ------ |
| numerical features... | binary features... | target |
| --------------------- | ------------------ | ------ |
| 0.1 3 5 ...           | 1 0 1 0 0 0        | ...    |
...
| 0.5 10 1 ...          | 0 0 1 0 0 1        | ...    |
| --------------------- | ------------------ | ------ |
</code></pre></div>
<h6 id="ordering-features">Ordering Features</h6>
<p>To facilitate the ease of use for FedImpute, you have to order the features in the dataset such that the <strong>numerical features</strong> are placed first, followed by the <strong>binary features</strong>.
The <strong>target variable</strong> should be the <strong><em>last</em></strong> column in the dataset.</p>
<h6 id="one-hot-encoding-categorical-features">One-hot Encoding Categorical Features</h6>
<p>Currently, FedImpute only supports <strong>numerical</strong> and <strong>binary</strong> features, does <strong><em>not</em></strong> support <strong>categorical</strong> features in the dataset.
So you have to one-hot encode the categorical features into binary features before using FedImpute.</p>
<h6 id="data-normalization-optional">Data Normalization (Optional)</h6>
<p>It is recommended to normalize the numerical features in the dataset within range of 0 and 1.</p>
<h3 id="helper-functions-for-preprocessing">Helper Functions for Preprocessing</h3>
<p>FedImpute provides several helper functions to perform the required preprocessing steps. Example of the helper functions are as follows:</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fedimpute.data_prep.helper</span> <span class="kn">import</span> <span class="n">ordering_features</span><span class="p">,</span> <span class="n">one_hot_encoding</span>

<span class="c1"># Example for data with numpy array </span>
<span class="n">data</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ordering_features</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">target_col</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">one_hot_encoding</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">numerical_cols_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_cateogories</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Example data with pandas dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ordering_features</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">],</span> 
    <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;house_price&#39;</span>
<span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">one_hot_encoding</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">numerical_cols_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_cateogories</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
- <code>ordering_features(data, numerical_cols: List[str or int], target_col: int or str)</code>: This function will order the features in the dataset such that the numerical features are placed first, followed by the binary features. The target variable should be the last column in the dataset.
- <code>one_hot_encoding(data, numerical_cols_num: int)</code>: This function will one-hot encode the categorical features into binary features. It assumes you data is already orderd as numerical cols + cat_cols + target, so You just need to specify the number of numerical columns.
<strong><em>Note</em></strong>: The <code>ordering_features</code> function is required to be called before the <code>one_hot_encoding</code> function.</p>
<p>We also provide a one-for-all function to perform all the preprocessing steps at once. 
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">fedimpute.data_prep</span> <span class="kn">import</span> <span class="n">prep_data</span>

<span class="n">data</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">prep_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">],</span> <span class="n">target_col</span><span class="o">=</span><span class="s1">&#39;house_price&#39;</span>
<span class="p">)</span>
</code></pre></div></p>
<h2 id="data-configuration-dictionary">Data Configuration Dictionary</h2>
<p>To allow FedImpute to understand the data and the task type, you need to provide a configuration dictionary called <code>data_config</code>.
The example of the <code>data_config</code> dictionary is as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">data_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;house_price&#39;</span><span class="p">,</span>
    <span class="s1">&#39;task_type&#39;</span><span class="p">:</span> <span class="s1">&#39;classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;clf_type&#39;</span><span class="p">:</span> <span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_cols&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;natural_partition&#39;</span><span class="p">:</span> <span class="kc">False</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>data_config</code> dictionary should contain the following keys:</p>
<ul>
<li><code>target</code>: The target variable name. </li>
<li><code>task_type</code>: The task type of the target variable. It can be either <code>classification</code> or <code>regression</code>.</li>
<li><code>clf_type</code>: The classification type of the target variable. It can be either <code>binary</code> or <code>multi-class</code> for classification task. And set it to <code>None</code> for the regression task.</li>
<li><code>num_cols</code>: The number of columns which are numerical (continous variable). </li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../get_started/" class="btn btn-neutral float-left" title="Install & Basic Usage"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../scenario_simulation/" class="btn btn-neutral float-right" title="Federated Missing Data Scenario Simulation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../get_started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../scenario_simulation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
